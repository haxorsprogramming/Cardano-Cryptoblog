/* 
 * Widgets for Social Network photo stream.
 * 
 * Author: Pixel Industry
 * Website: http://pixel-industry.com
 * Version: 1.4
 *
 */


!function(a){a.fn.socialstream=function(b){var c={socialnetwork:"flickr",username:"pixel-industry",limit:6,overlay:!0,apikey:!1,accessToken:"",picasaAlbumId:""},b=a.extend(c,b);return this.each(function(){function h(d){a.get("https://www.googleapis.com/youtube/v3/playlistItems",{part:"snippet",maxResults:b.limit,playlistId:d,key:b.apikey},function(d){var f='<ul class="youtube-list">';a.each(d.items,function(c,d){var e=d.snippet.thumbnails.default.url,g="";if(!e)return!1;var i=(a("<div></div>"),"https://www.youtube.com/watch?v="+d.snippet.resourceId.videoId),j=d.snippet.title;if(b.overlay)var g='<div class="img-overlay"></div>';f+='<li><a target="_blank" href="'+i+'" title="'+j+'"><img src="'+e+'"/>'+g+"</a></li>"}),f+="</ul>",a(c).append(f)})}var c=a(this);switch(b.socialnetwork){case"flickr":c.append('<ul class="flickr-list"></ul>'),a.getJSON("https://api.flickr.com/services/rest/?method=flickr.people.findByUsername&username="+b.username+"&format=json&api_key=32ff8e5ef78ef2f44e6a1be3dbcf0617&jsoncallback=?",function(d){var e=d.user.nsid;a.getJSON("https://api.flickr.com/services/rest/?method=flickr.photos.search&user_id="+e+"&format=json&api_key=85145f20ba1864d8ff559a3971a0a033&per_page="+b.limit+"&page=1&extras=url_sq&jsoncallback=?",function(d){a.each(d.photos.photo,function(d,e){var f=e.owner,g=e.title,h=e.url_sq,i=e.id,j="https://www.flickr.com/photos/"+f+"/"+i,k=a("<img/>").attr({src:h,alt:g}),l=a("<a/>").attr({href:j,target:"_blank",title:g}),m=a(l).append(k);if(b.overlay){var n=a("<div/>").addClass("img-overlay");a(l).append(n)}var o=a("<li/>").append(m);a("ul",c).append(o)})})});break;case"pinterest":var d="http://pinterest.com/"+b.username+"/feed.rss",e="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q="+encodeURIComponent(d)+"&num="+b.limit+"&output=json_xml";a.getJSON(e,function(d){if(200==d.responseStatus){var e=d.responseData.feed,f="";if(!e)return!1;for(var g='<ul class="pinterest-list">',h=0;h<e.entries.length;h++){var i=e.entries[h],j=a("<div></div>");j.append(i.content);var k="http://www.pinterest.com"+j.find("a").attr("href"),l=j.find("img").attr("src"),m=j.find("p:nth-child(2)").html();if(b.overlay)var f='<div class="img-overlay"></div>';g+='<li><a target="_blank" href="'+k+'" title="'+m+'"><img src="'+l+'"/>'+f+"</a></li>"}g+="</ul>",a(c).append(g)}});break;case"instagram":if(c.append('<ul class="instagram-list"></ul>'),"undefined"==typeof b.accessToken||""==b.accessToken)return void console.warn("Instagram Access Token is not set. Please enter it in plugin init call.");var f=b.accessToken;d="https://api.instagram.com/v1/users/search?q="+b.username+"&access_token="+f+"&count=1&callback=?",a.getJSON(d,function(e){a.each(e.data,function(e,g){var h=g.username;if(h==b.username){var i=g.id;""!=i&&(d="https://api.instagram.com/v1/users/"+i+"/media/recent/?access_token="+f+"&count="+b.limit+"&callback=?",a.getJSON(d,function(d){a.each(d.data,function(d,e){var f=e.images.thumbnail.url,g=e.link,h="";null!=e.caption&&(h=e.caption.text);var i=a("<img/>").attr({src:f,alt:h}),j=a("<a/>").attr({href:g,target:"_blank",title:h}),k=a(j).append(i);if(b.overlay){var l=a("<div/>").addClass("img-overlay");a(j).append(l)}var m=a("<li/>").append(k);a("ul",c).append(m)})}))}})});break;case"dribbble":if(c.append('<ul class="dribbble-list"></ul>'),"undefined"==typeof b.accessToken||""==b.accessToken)return void console.warn("Dribbble Access Token is not set. Please enter it in plugin init call.");var f=b.accessToken;a.getJSON("https://api.dribbble.com/v1/users/"+b.username+"/shots?access_token="+f+"&callback=?",function(d){a.each(d.data,function(d,e){if(d<b.limit){var f=e.title,g=a("<img/>").attr({src:e.images.teaser,alt:f}),h=a("<a/>").attr({href:e.html_url,target:"_blank",title:f}),i=a(h).append(g);if(b.overlay){var j=a("<div/>").addClass("img-overlay");a(h).append(j)}var k=a("<li/>").append(i);a("ul",c).append(k)}})});break;case"deviantart":var d="http://backend.deviantart.com/rss.xml?type=deviation&q=by%3A"+b.username+"+sort%3Atime+meta%3Aall",e="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q="+encodeURIComponent(d)+"&num="+b.limit+"&output=json_xml";a.getJSON(e,function(d){if(200==d.responseStatus){var e=d.responseData.feed,f="";if(!e)return!1;for(var g='<ul class="deviantart-list">',h=0;h<e.entries.length;h++){var i=e.entries[h],j=a("<div></div>");j.append(i.content);var k=i.link,l=j.find("img").attr("src");if(!(l.indexOf("smile.gif")>=0)){var m=i.title.replace(/.jpg/g,"").replace(/-/g," ").replace(/_/g," ");if(b.overlay)var f='<div class="img-overlay"></div>';g+='<li><a target="_blank" href="'+k+'" title="'+m+'"><img src="'+l+'"/>'+f+"</a></li>"}}g+="</ul>",a(c).append(g)}});break;case"youtube":var g;b.apikey&&a.get("https://www.googleapis.com/youtube/v3/channels",{part:"contentDetails",id:b.username,key:b.apikey},function(b){a.each(b.items,function(a,b){g=b.contentDetails.relatedPlaylists.uploads,h(g)})});break;case"newsfeed":var e="http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&q="+encodeURIComponent(b.username)+"&num="+b.limit+"&output=json_xml";a.getJSON(e,function(d){if(200==d.responseStatus){var e=d.responseData.feed,f="";if(!e)return!1;for(var g='<ul class="social-feed">',h=0;h<e.entries.length;h++){var i=e.entries[h],j=a("<div></div>");j.append(i.content);var k=i.link,l=j.find("img").attr("src"),m=i.title.replace(/.jpg/g,"").replace(/-/g," ").replace(/_/g," ");if(b.overlay)var f='<div class="img-overlay"></div>';g+='<li><a target="_blank" href="'+k+'" title="'+m+'"><img src="'+l+'"/>'+f+"</a></li>"}g+="</ul>",a(c).append(g)}})}})}}(jQuery);